import getopt,sys,time
import os
from fullsettings import *
from FtpNodeComponent import FtpNodeComponent
from database import *

class CapCopier(FtpNodeComponent):
    
    def __init__(self,destCap,ftpDetails):
        self.destDb = database(destCap,destCap)
        FtpNodeComponent.__init__(self,None,None,ftpDetails,None)
        self.triggerQueries = QuantSettings.triggerQueries
        self._capTablesToCopy.extend(QualSettings.capTablesToCopy[:])
        #self._capTablesToCopy.extend(QuantSettings.capTablesToCopy)
        
    
    def CopyDataForDocuments(self,documents):
        self._copyDataFromNode(documents, self.destDb, self._capTablesToCopy)
        print 'copied for ',documents
        
if __name__ == '__main__':
    dest = '236'
    ftpDetails = ['10.25.0.150','21','SYSAUTO','qwdfvb']
    n = 40
    docList = ["1100000023","1100000024","1100000025","1100000026","1100000027","1100000028","1100000029","1100000030","1100000031","1100000032","1100000033","1100000034","1100000035","1100000036","1100000037","1100000038","1100000039","1100000040","1100000041","1100000042","1100000043","1100000044","1100000045","1100000046","1100000047","1100000048","1100000049","1100000050","1100000051","1100000052","1100000053","1100000054","1100000055","1100000056","1100000057","1100000058","1100000059","1100000060","1100000061","1100000062","1100000063","1100000064","1100000065","1100000066","1100000067","1100000068","1100000069","1100000070","1100000071","1100000072","1100000073","1100000074","1100000075","1100000076","1100000077","1100000078","1100000079","1100000080","1100000081","1100000082","1100000083","1100000084","1100000085","1100000086","1100000087","1100000088","1100000089","1100000090","1100000091","1100000092","1100000093","1100000094","1100000095","1100000096","1100000097","1100000098","1100000099","1100000100","1100000101","1100000102","1100000103","1100000104","1100000105","1100000106","1100000107","1100000108","1100000109","1100000110","1100000111","1100000112","1100000113","1100000114","1100000115","1100000116","1100000117","1100000118","1100000119","1100000120","1100000121","1100000122","1100000123","1100000124","1100000125","1100000126","1100000127","1100000128","1100000129","1100000130","1100000131","1100000132","1100000133","1100000134","1100000135","1100000136","1100000137","1100000138","1100000139","1100000140","1100000141","1100000142","1100000143","1100000144","1100000145","1100000146","1100000147","1100000148","1100000149","1100000150","1100000151","1100000152","1100000153","1100000154","1100000155","1100000156","1100000157","1100000158","1100000159","1100000160","1100000161","1100000162","1100000163","1100000164","1100000165","1100000166","1100000167","1100000168","1100000169","1100000170","1100000171","1100000172","1100000173","1100000174","1100000175","1100000176","1100000177","1100000178","1100000179","1100000180","1100000181","1100000182","1100000183","1100000184","1100000185","1100000186","1100000187","1100000188","1100000189","1100000190","1100000191","1100000192","1100000193","1100000194","1100000195","1100000196","1100000197","1100000198","1100000199","1100000200","1100000201","1100000202","1100000203","1100000204","1100000205","1100000206","1100000207","1100000208","1100000209","1100000210","1100000211","1100000212","1100000213","1100000214","1100000215","1100000216","1100000217","1100000218","1100000219","1100000220","1100000221","1100000222","1100000223","1100000224","1100000225","1100000226","1100000227","1100000228","1100000229","1100000230","1100000231","1100000232","1100000233","1100000234","1100000235","1100000236","1100000237","1100000238","1100000239","1100000240","1100000241","1100000242","1100000243","1100000244","1100000245","1100000246","1100000247","1100000248","1100000249","1100000250","1100000251","1100000252","1100000253","1100000254","1100000255","1100000256","1100000257","1100000258","1100000259","1100000260","1100000261","1100000262","1100000263","1100000264","1100000265","1100000266","1100000267","1100006889","1100006890","1100006891","1100006892","1100006893","1100006894","1100006895","1100006896","1100006897","1100006898","1100006899","1100006900","1100006901","1100006902","1100006903","1100006904","1100006905","1100006906","1100006907","1100006908","1100006909","1100006910","1100006911","1100006912","1100006913","1100006914","1100006915","1100006916","1100006917","1100006918","1100006919","1100006920","1100006921","1100006922","1100006923","1100006924","1100006925","1100006926","1100006927","1100006928","1100006929","1100006930","1100006931","1100006932","1100006933","1100006934","1100006935","1100006936","1100006937","1100006938","1100006939","1100006940","1100006941","1100006942","1100006943","1100006944","1100006945","1100006946","1100006947","1100006948","1100006949","1100006950","1100006951","1100006952","1100006953","1100006954","1100006955","1100006956","1100006957","1100006958","1100006959","1100006960","1100006961","1100006962","1100006963","1100006964","1100006965","1100006966","1100006967","1100006968","1100006969","1100006970","1100006971","1100006972","1100006973","1100006974","1100006975","1100006976","1100006977","1100006978","1100006979","1100006980","1100006981","1100006982","1100006983","1100006984","1100006985","1100006986","1100006987","1100006988","1100006989","1100006990","1100006991","1100006992","1100006993","1100006994","1100006995","1100006996","1100006997","1100006998","1100006999","1100007000","1100007001","1100007002","1100007003","1100007004","1100007005","1100007006","1100007007","1100007008","1100007009","1100007010","1100007011","1100007012","1100007013","1100007014","1100007015","1100007016","1100007017","1100007018","1100007019","1100007020","1100007021","1100007022","1100007023","1100007024","1100007025","1100007026","1100007027","1100007028","1100007029","1100007030","1100007031","1100007032","1100007033","1100007034","1100007035","1100007036","1100007037","1100007038","1100007039","1100007040","1100007041","1100007042","1100007043","1100007044","1100007045","1100007046","1100007047","1100007048","1100007049","1100007050","1100007051","1100007052","1100007053","1100007054","1100007055","1100007056","1100007057","1100007058","1100007059","1100007060","1100007061","1100007062","1100007063","1100007064","1100007065","1100007066","1100007067","1100007068","1100007069","1100007070","1100007071","1100007072","1100007073","1100007074","1100007075","1100007076","1100007077","1100007078","1100007079","1100007080","1100007081","1100007082","1100007083","1100007084","1100007085","1100007086","1100007087","1100007088","1100007089","1100007090","1100007091","1100007092","1100007093","1100007094","1100007095","1100007096","1100007097","1100007098","1100007099","1100007100","1100007101","1100007102","1100007103","1100007104","1100007105","1100007106","1100007107","1100007108","1100007109","1100007110","1100007111","1100007112","1100007113","1100007114","1100007115","1100007116","1100007117","1100007118","1100007119","1100007120","1100007121","1100007122","1100007123","1100007124","1100007125","1100007126","1100007127","1100007128","1100007129","1100007130","1100007131","1100007132","1100007133","1100007134","1100007135","1100007136","1100007137","1100007138","1100007139","1100007140","1100007141","1100007142","1100007143","1100007144","1100007145","1100007146","1100007147","1100007148","1100007149","1100007150","1100007151","1100007152","1100007153","1100007154","1100007155","1100007156","1100007157","1100007158","1100007159","1100007160","1100007161","1100007162","1100007163","1100007164","1100007165","1100007166","1100007167","1100007168","1100007169","1100007170","1100007171","1100007172","1100007173","1100007174","1100007175","1100007176","1100007177","1100007178","1100007179","1100007180","1100007181","1100007182","1100007183","1100007184","1100007185","1100007186","1100007187","1100007188","1100007189","1100007190","1100007191","1100007192","1100007193","1100007194","1100007195","1100007196","1100007197","1100007198","1100007199","1100007200","1100007201","1100007202","1100007203","1100007204","1100007205","1100007206","1100007207","1100007208","1100007209","1100007210","1100007211","1100007212","1100007213","1100007214","1100007215","1100007216","1100007217","1100007218","1100007219","1100007220","1100007221","1100007222","1100007223","1100007224","1100007225","1100007226","1100007227","1100007228","1100007229","1100007230","1100007231","1100007232","1100007233","1100007234","1100007235","1100007236","1100007237","1100007238","1100007239","1100007240","1100007241","1100007242","1100007243","1100007244","1100007245","1100007246","1100007247","1100007248","1100007249","1100007250","1100007251","1100007252","1100007253","1100007254","1100007255","1100007256","1100007257","1100007258","1100007259","1100007260","1100007261","1100007262","1100007263","1100007264","1100007265","1100007266","1100007267","1100007268","1100007269","1100007270","1100007271","1100007272","1100007273","1100007274","1100007275","1100007276","1100007277","1100007278","1100007279","1100007280","1100007281","1100007282","1100007283","1100007284","1100007285","1100007286","1100007287","1100007288","1100007289","1100007290","1100007291","1100007292","1100007293","1100007294","1100007295","1100007296","1100007297","1100007298","1100007299","1100007300","1100007301","1100007302","1100007303","1100007304","1100007305","1100007306","1100007307","1100007308","1100007309","1100007310","1100007311","1100007312","1100007313","1100007314","1100007315","1100007316","1100007317","1100007318","1100007319","1100007320","1100007321","1100007322","1100007323","1100007324","1100007325","1100007326","1100007327","1100007328","1100007329","1100007330","1100007331","1100007332","1100007333","1100007334","1100007335","1100007336","1100007337","1100007338","1100007339","1100007340","1100007341","1100007342","1100007343","1100007344","1100007345","1100007346","1100007347","1100007348","1100007349","1100007350","1100007351","1100007352","1100007353","1100007354","1100007355","1100007356","1100007357","1100007358","1100007359","1100007360","1100007361","1100007362","1100007363","1100007364","1100007365","1100007366","1100007367","1100007368","1100007369","1100007370","1100007371","1100007372","1100007373","1100007374","1100007375","1100007376","1100007377","1100007378","1100007379","1100007380","1100007381","1100007382","1100007383","1100007384","1100007385","1100007386","1100007387","1100007388","1100007389","1100007390","1100007391","1100007392","1100007393","1100007394","1100007395","1100007396","1100007397","1100007398","1100007399","1100007400","1100007401","1100007402","1100007403","1100007404","1100007405","1100007406","1100007407","1100007408","1100007409","1100007410","1100007411","1100007412","1100007413","1100007414","1100007415","1100007416","1100007417","1100007418","1100007419","1100007420","1100007421","1100007422","1100007423","1100007424","1100007425","1100007426","1100007427","1100007428","1100007429","1100007430","1100007431","1100007432","1100007433","1100007434","1100007435","1100007436","1100007437","1100007438","1100007439","1100007440","1100007441","1100007442","1100007443","1100007444","1100007445","1100007446","1100007447","1100007448","1100007449","1100007450","1100007451","1100007452","1100007453","1100007454","1100007455","1100007456","1100007457","1100007458","1100007459","1100007460","1100007461","1100007462","1100007463","1100007464","1100007465","1100007466","1100007467","1100007468","1100007469","1100007470","1100007471","1100007472","1100007473","1100007474","1100007475","1100007476","1100007477","1100007478","1100007479","1100007480","1100007481","1100007482","1100007483","1100007484","1100007485","1100007486","1100007487","1100007488","1100007489","1100007490","1100007491","1100007492","1100007493","1100007494","1100007495","1100007496","1100007497","1100007498","1100007499","1100007500","1100007501","1100007502","1100007503","1100007504","1100007505","1100007506","1100007507","1100007508","1100007509","1100007510","1100007511","1100007512","1100007513","1100007514","1100007515","1100007516","1100007517","1100007518","1100007519","1100007520","1100007522","1100007523","1100007524","1100007525","1100007526","1100007527","1100007528","1100007529","1100007530","1100007531","1100007532","1100007533","1100007534","1100007535","1100007536","1100007537","1100007538","1100007539","1100007540","1100007541","1100007542","1100007543","1100007544","1100007545","1100007546","1100007547","1100007548","1100007549","1100007550","1100007551","1100007552","1100007553","1100007554","1100007555","1100007556","1100007557","1100007558","1100007559","1100007560","1100007561","1100007562","1100007563","1100007564","1100007565","1100007566","1100007567","1100007568","1100007569","1100007570","1100007571","1100007572","1100007573","1100007574","1100007575","1100007576","1100007577","1100007578","1100007579","1100007580","1100007581","1100007582","1100007583","1100007584","1100007585","1100007586","1100007587","1100007588","1100007589","1100007590","1100007591","1100007592","1100007593","1100007594","1100007595","1100007596","1100007597","1100007598","1100007599","1100007600","1100007601","1100007602","1100007603","1100007604","1100007605","1100007606","1100007607","1100007608","1100007609","1100007610","1100007611","1100007612","1100007613","1100007614","1100007615","1100007616","1100007617","1100007618","1100007619","1100007620","1100007621","1100007622","1100007623","1100007624","1100007625"]
    docBatches = [docList[i::n] for i in range(n)]
    capCopier = CapCopier(dest,ftpDetails)
    for docBatch in docBatches:
        capCopier.CopyDataForDocuments(docBatch)